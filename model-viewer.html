<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- Import the component -->
    <script
      type="module"
      src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"
    ></script>
  </head>
  <body>
    <!-- Use it like any other HTML element -->
    <div style="width: 1960px; min-height: 1000px">
      
        <model-viewer min-camera-orbit="auto 0deg auto" max-camera-orbit="auto 87deg auto" exposure="2" interaction-prompt="none" id="sphere"  restrict-gltf-model="y"  style="width: 2000px;height: 1010px;background: #524949;" src="models/coc.glb" ar ar-modes="webxr scene-viewer quick-look" camera-controls   poster="https://modelviewer.dev/shared-assets/models/poster.webp" shadow-intensity="0" shadow-softness="0" auto-rotate environment-image="https://modelviewer.dev/shared-assets/environments/pillars_1k.hdr" skybox-image="https://modelviewer.dev/shared-assets/environments/pillars_1k.hdr" exposure="0.93" tone-mapping="commerce">
            <!-- <button class="Hotspot" slot="hotspot-1" data-position="55.28052140295167m 218.78245184028825m 59.460595041930304m" data-normal="0.920111858506995m 0.24987071515428513m -0.3015937558091846m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Mắt</div>
            </button><button class="Hotspot" slot="hotspot-2" data-position="14.72914806775384m 56.98670892812066m 144.19812363743807m" data-normal="0.046229452927815266m 0.44577144012449155m 0.8939522698955085m" data-visibility-attribute="visible">
                <div class="HotspotAnnotation">Bệ đỡ</div>
            </button> -->
            <div class="controls">
                <div>
                  <p>Kim loại: <span id="metalness-value"></span></p>
                  <input id="metalness" type="range" min="0" max="1" step="0.01" value="1">
                </div>
                <div>
                  <p>Độ nhám: <span id="roughness-value"></span></p>
                  <input id="roughness" type="range" min="0" max="1" step="0.01" value="0">
                </div>
                <div>
                    <p>Phơi sáng: <span id="exposure-value"></span></p>
                    <input id="exposure" type="range" min="0" max="10" step="0.01" value="2" oninput="changeExposure(this.value)">
                  </div>
                  <input type="checkbox" id="skybox-checkbox" checked> Bật/tắt môi trường
                  <!-- Bloom  -->
                  <effect-composer render-mode="quality" msaa="8">
                    <bloom-effect></bloom-effect>
                  </effect-composer>
                </model-viewer>
                <div class="controls">
                  <label for="bloom">Bloom Effect</label>
                  <input type="checkbox" id="bloom" checked>
                </div>
        </model-viewer>
        
       
      
    </div>
    <script>
        const modelViewerParameters = document.querySelector("model-viewer#sphere");
        
        modelViewerParameters.addEventListener("load", (ev) => {
        
          let material = modelViewerParameters.model.materials[0];
        
          let metalnessDisplay = document.querySelector("#metalness-value");
          let roughnessDisplay = document.querySelector("#roughness-value");
       
        
          metalnessDisplay.textContent = material.pbrMetallicRoughness.metallicFactor;
          roughnessDisplay.textContent = material.pbrMetallicRoughness.roughnessFactor;
      
          // Defaults to gold
          material.pbrMetallicRoughness.setBaseColorFactor([0.7294, 0.5333, 0.0392]);
        
          document.querySelector('#metalness').addEventListener('input', (event) => {
            material.pbrMetallicRoughness.setMetallicFactor(event.target.value);
            metalnessDisplay.textContent = event.target.value;
          });
        
          document.querySelector('#roughness').addEventListener('input', (event) => {
            material.pbrMetallicRoughness.setRoughnessFactor(event.target.value);
            roughnessDisplay.textContent = event.target.value;
          });
         
        });
        function changeExposure(value) {
        document.getElementById('sphere').setAttribute('exposure', value);
        document.getElementById('exposure-value').innerText = value;
        document.getElementById('exposure-value').textContent = value;
    }

    const sphere = document.getElementById('sphere');
const skyboxCheckbox = document.getElementById('skybox-checkbox');

skyboxCheckbox.addEventListener('change', function() {
  if (this.checked) {
    // Bật chế độ sử dụng môi trường làm skybox
    sphere.setAttribute('skybox-image', 'https://modelviewer.dev/shared-assets/environments/pillars_1k.hdr');
  } else {
    // Tắt chế độ sử dụng môi trường làm skybox
    sphere.removeAttribute('skybox-image');
  }
});




        </script>
        
        <script type="module">
            const viewer = document.querySelector("model-viewer#sphere");
            const bloomEffect = viewer.querySelector('bloom-effect');
            const bloomCheckbox = document.querySelector('#bloom');
          
            bloomCheckbox.addEventListener('change', (e) => {
                console.log(e);
              bloomEffect.intensity = e.target.checked ? 1 : 0;
            });

            
          </script>
  </body>
</html>
